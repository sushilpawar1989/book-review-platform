name: ğŸ§ª Manual Test Workflow

on:
  workflow_dispatch:
    inputs:
      test_type:
        description: 'Type of test to run'
        required: true
        default: 'build'
        type: choice
        options:
        - build
        - test
        - docker
        - full
      environment:
        description: 'Environment to test'
        required: true
        default: 'development'
        type: choice
        options:
        - development
        - staging
        - production

jobs:
  manual-test:
    name: ğŸ§ª Manual Test - ${{ github.event.inputs.test_type }}
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout Code
      uses: actions/checkout@v4
      
    - name: ğŸ“‹ Display Test Parameters
      run: |
        echo "ğŸ§ª Test Type: ${{ github.event.inputs.test_type }}"
        echo "ğŸŒ Environment: ${{ github.event.inputs.environment }}"
        echo "ğŸ”— Triggered by: ${{ github.actor }}"
        echo "ğŸ“… Timestamp: $(date)"
        
    - name: ğŸ—ï¸ Backend Test
      if: contains(github.event.inputs.test_type, 'build') || contains(github.event.inputs.test_type, 'full')
      run: |
        echo "ğŸ—ï¸ Testing Backend Build..."
        cd backend
        chmod +x ./gradlew
        ./gradlew clean build -x test
        echo "âœ… Backend build successful!"
        
    - name: âš›ï¸ Frontend Test  
      if: contains(github.event.inputs.test_type, 'build') || contains(github.event.inputs.test_type, 'full')
      run: |
        echo "âš›ï¸ Testing Frontend Build..."
        cd frontend
        npm ci
        npm run build
        echo "âœ… Frontend build successful!"
        
    - name: ğŸ§ª Run Tests
      if: contains(github.event.inputs.test_type, 'test') || contains(github.event.inputs.test_type, 'full')
      run: |
        echo "ğŸ§ª Running Tests..."
        cd backend && ./gradlew test
        cd ../frontend && npm test -- --watchAll=false
        echo "âœ… All tests passed!"
        
    - name: ğŸ³ Docker Test
      if: contains(github.event.inputs.test_type, 'docker') || contains(github.event.inputs.test_type, 'full')
      run: |
        echo "ğŸ³ Testing Docker Builds..."
        docker --version
        docker-compose --version
        echo "âœ… Docker environment ready!"
        
    - name: ğŸ‰ Test Complete
      run: |
        echo "ğŸ‰ Manual test completed successfully!"
        echo "ğŸ“Š Results summary:"
        echo "  - Test Type: ${{ github.event.inputs.test_type }}"
        echo "  - Environment: ${{ github.event.inputs.environment }}"
        echo "  - Status: âœ… PASSED"
